<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>Measurement &amp; Multilevel Modeling Lab: IRT and CFA</title>

<meta property="description" itemprop="description" content="A comparison of Item Response Theory (IRT) and Confirmatory Factor Analysis (CFA)"/>

<link rel="canonical" href="https://mmmlab.rbind.io/posts/2024-04-22-cfa-vs-irt/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2024-04-22"/>
<meta property="article:created" itemprop="dateCreated" content="2024-04-22"/>
<meta name="article:author" content="Alex Miles"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Measurement &amp; Multilevel Modeling Lab: IRT and CFA"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="A comparison of Item Response Theory (IRT) and Confirmatory Factor Analysis (CFA)"/>
<meta property="og:url" content="https://mmmlab.rbind.io/posts/2024-04-22-cfa-vs-irt/"/>
<meta property="og:image" content="https://mmmlab.rbind.io/posts/2024-04-22-cfa-vs-irt/IRT_and_CFA_files/figure-html5/loadData-1.png"/>
<meta property="og:image:width" content="1248"/>
<meta property="og:image:height" content="768"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Measurement &amp; Multilevel Modeling Lab"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Measurement &amp; Multilevel Modeling Lab: IRT and CFA"/>
<meta property="twitter:description" content="A comparison of Item Response Theory (IRT) and Confirmatory Factor Analysis (CFA)"/>
<meta property="twitter:url" content="https://mmmlab.rbind.io/posts/2024-04-22-cfa-vs-irt/"/>
<meta property="twitter:image" content="https://mmmlab.rbind.io/posts/2024-04-22-cfa-vs-irt/IRT_and_CFA_files/figure-html5/loadData-1.png"/>
<meta property="twitter:image:width" content="1248"/>
<meta property="twitter:image:height" content="768"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Measurement &amp; Multilevel Modeling Lab: IRT and CFA"/>
<meta name="citation_fulltext_html_url" content="https://mmmlab.rbind.io/posts/2024-04-22-cfa-vs-irt/"/>
<meta name="citation_online_date" content="2024/04/22"/>
<meta name="citation_publication_date" content="2024/04/22"/>
<meta name="citation_author" content="Alex Miles"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Interchangeability between factor analysis, logistic IRT, and normal ogive IRT;citation_volume=14;citation_doi=10.3389/fpsyg.2023.1267219;citation_author=Eunseong Cho"/>
  <meta name="citation_reference" content="citation_title=ltm: An R Package for Latent Variable Modeling and Item Response Theory Analyses;citation_volume=17;citation_doi=10.18637/jss.v017.i05;citation_author=Dimitris Rizopoulos"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","categories","bibliography","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["IRT and CFA"]},{"type":"character","attributes":{},"value":["A comparison of Item Response Theory (IRT) and Confirmatory Factor Analysis (CFA)"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Alex Miles"]}]}]},{"type":"character","attributes":{},"value":["2024-04-22"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["psychometrics","item response theory","factor analysis"]},{"type":"character","attributes":{},"value":["references.bib"]},{"type":"character","attributes":{},"value":["https://mmmlab.rbind.io/posts/2024-04-22-cfa-vs-irt/"]},{"type":"character","attributes":{},"value":["https://mmmlab.rbind.io/posts/2024-04-22-cfa-vs-irt/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["IRT_and_CFA_files/anchor-4.2.2/anchor.min.js","IRT_and_CFA_files/bowser-1.9.3/bowser.min.js","IRT_and_CFA_files/distill-2.2.21/template.v2.js","IRT_and_CFA_files/figure-html5/loadData-1.png","IRT_and_CFA_files/figure-html5/unnamed-chunk-1-1.png","IRT_and_CFA_files/figure-html5/unnamed-chunk-13-1.png","IRT_and_CFA_files/figure-html5/unnamed-chunk-13-2.png","IRT_and_CFA_files/figure-html5/unnamed-chunk-13-3.png","IRT_and_CFA_files/figure-html5/unnamed-chunk-14-1.png","IRT_and_CFA_files/figure-html5/unnamed-chunk-16-1.png","IRT_and_CFA_files/figure-html5/unnamed-chunk-16-2.png","IRT_and_CFA_files/figure-html5/unnamed-chunk-17-1.png","IRT_and_CFA_files/figure-html5/unnamed-chunk-2-1.png","IRT_and_CFA_files/figure-html5/unnamed-chunk-6-1.png","IRT_and_CFA_files/figure-html5/unnamed-chunk-7-1.png","IRT_and_CFA_files/figure-html5/unnamed-chunk-8-1.png","IRT_and_CFA_files/header-attrs-2.25/header-attrs.js","IRT_and_CFA_files/header-attrs-2.26/header-attrs.js","IRT_and_CFA_files/jquery-3.6.0/jquery-3.6.0.js","IRT_and_CFA_files/jquery-3.6.0/jquery-3.6.0.min.js","IRT_and_CFA_files/jquery-3.6.0/jquery-3.6.0.min.map","IRT_and_CFA_files/popper-2.6.0/popper.min.js","IRT_and_CFA_files/tippy-6.2.7/tippy-bundle.umd.min.js","IRT_and_CFA_files/tippy-6.2.7/tippy-light-border.css","IRT_and_CFA_files/tippy-6.2.7/tippy.css","IRT_and_CFA_files/tippy-6.2.7/tippy.umd.min.js","IRT_and_CFA_files/webcomponents-2.0.0/webcomponents.js","references.bib"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.1/jquery-3.6.1.min.js"></script>
<link href="../../site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.25/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"IRT and CFA","description":"A comparison of Item Response Theory (IRT) and Confirmatory Factor Analysis (CFA)","authors":[{"author":"Alex Miles","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2024-04-22T00:00:00.000-07:00","citationText":"Miles, 2024"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo">
<img src="../../static/images/mmm_white_transparent.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">Measurement &amp; Multilevel Modeling Lab</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../about.html">About</a>
<a href="../../members.html">Members</a>
<a href="../../research.html">Research</a>
<a href="../../publications.html">Publications</a>
<a href="../../Labnews.html">Lab News</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Applications
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="https://mmmlabusc.shinyapps.io/partinvshinyui/">Unbiasr Shiny App</a>
<a href="https://winnie-wy-tse.shinyapps.io/hcb_shiny/">HCB Shiny App</a>
<a href="https://github.com/Gengrui-Zhang/R2spa">R2spa</a>
<a href="https://marklhc.github.io/pinsearch/articles/pinsearch.html">pinsearch (R package)</a>
<a href="https://github.com/winniewytse/hcbr">hcbr (R package)</a>
<a href="https://github.com/mmm-usc/unbiasr">unbiasr (R package)</a>
</div>
</div>
<a href="https://github.com/mmm-usc">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>IRT and CFA</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:psychometrics" class="dt-tag">psychometrics</a>
  <a href="../../index.html#category:item_response_theory" class="dt-tag">item response theory</a>
  <a href="../../index.html#category:factor_analysis" class="dt-tag">factor analysis</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>A comparison of Item Response Theory (IRT) and Confirmatory Factor Analysis (CFA)</p></p>
</div>

<div class="d-byline">
  
  Alex Miles
  
<br/>2024-04-22
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#the-data" id="toc-the-data">The Data</a></li>
<li><a href="#import-dataset" id="toc-import-dataset">Import Dataset</a></li>
<li><a href="#fit-1pl-model" id="toc-fit-1pl-model">Fit 1PL Model</a></li>
<li><a href="#fit-2pl-model" id="toc-fit-2pl-model">Fit 2PL Model</a></li>
<li><a href="#item-characteristic-curves" id="toc-item-characteristic-curves">Item Characteristic Curves</a></li>
<li><a href="#item-information-curves" id="toc-item-information-curves">Item Information Curves</a></li>
<li><a href="#sum-of-all-iic-curves" id="toc-sum-of-all-iic-curves">Sum of all IIC Curves</a></li>
<li><a href="#confirmatory-factor-analysis-with-dichotomous-data" id="toc-confirmatory-factor-analysis-with-dichotomous-data">Confirmatory Factor Analysis with Dichotomous Data</a></li>
<li><a href="#check-modification-indices" id="toc-check-modification-indices">Check Modification Indices</a></li>
<li><a href="#compare-discriminations-with-factor-loadings" id="toc-compare-discriminations-with-factor-loadings">Compare discriminations with factor loadings</a></li>
<li><a href="#graded-response-model" id="toc-graded-response-model">Graded Response Model</a></li>
<li><a href="#item-characteristic-and-item-information-curves" id="toc-item-characteristic-and-item-information-curves">Item Characteristic and Item Information Curves</a></li>
<li><a href="#pl-and-grm-test-information-function" id="toc-pl-and-grm-test-information-function">2PL and GRM Test Information Function</a></li>
<li><a href="#rating-scale-model" id="toc-rating-scale-model">Rating Scale Model</a></li>
<li><a href="#rsm-item-characteristic-curves" id="toc-rsm-item-characteristic-curves">RSM: Item Characteristic Curves</a></li>
<li><a href="#rsm-test-information-curve" id="toc-rsm-test-information-curve">RSM: Test Information Curve</a></li>
<li><a href="#log-likelihood-and-aic-of-grm-and-rsm" id="toc-log-likelihood-and-aic-of-grm-and-rsm">Log-Likelihood and AIC of GRM and RSM</a></li>
<li><a href="#confirmatory-factor-analysis-with-polytomous-data" id="toc-confirmatory-factor-analysis-with-polytomous-data">Confirmatory Factor Analysis with Polytomous Data</a></li>
<li><a href="#compare-discrimination-parameter-of-grm-and-factor-loadings-of-polytomous-cfa" id="toc-compare-discrimination-parameter-of-grm-and-factor-loadings-of-polytomous-cfa">Compare Discrimination Parameter of GRM and Factor Loadings of Polytomous CFA</a></li>
<li><a href="#conclusion" id="toc-conclusion">Conclusion</a></li>
</ul>
</nav>
</div>
<p>This analysis was originally written in Quarto and edited by Mark Lai in R Markdown format, and the source file can be found at</p>
<p><a href="https://github.com/alexm123/CFAvsIRT" class="uri">https://github.com/alexm123/CFAvsIRT</a></p>
<p>Below, I will analyze the same dataset using both Item Response Theory (IRT) and Confirmatory Factor Analysis (CFA) to compare and contrast between the two.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="the-data">The Data</h2>
<p>The 2015-2016 NHANES Mental Health - Depression Screener.</p>
<p>Originally a rating scale (0, Not at all; 1, several days; 2, more than half the days; 3, nearly everyday)</p>
<p>Q1: “Have little interest in doing things”</p>
<p>Q2: “Feeling down, depressed, or hopeless”</p>
<p>Q3: “Trouble sleeping or sleeping too much”</p>
<p>Q4: “Feeling tired or having little energy”</p>
<p>Q5: “Poor appetite or overeating”</p>
<p>Q6: “Feeling bad about yourself”</p>
<p>Q7: “Trouble concentrating on things”</p>
<p>Q8: “Moving or speaking slowly or too fast”</p>
<p>Q9: “Thought you would be better off dead”</p>
<p>Q10: “Difficulty these problems have caused”</p>
<p>Looking at the questions, we clearly see that Q10 does not fit in with the rest. It violates the assumption of local independence (A participant’s answer to Q10 depends on their answers to the other questions). To that end, I had Q10 dropped from the data set.</p>
<h2 id="import-dataset">Import Dataset</h2>
<p>For the initial analysis, I opted to dichotomize the data by having any value above 0 changed to a 1.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Mental Health - Depression Screener from</span></span>
<span><span class='co'># https://wwwn.cdc.gov/nchs/nhanes/search/datapage.aspx?Component=Questionnaire&amp;CycleBeginYear=2015</span></span>
<span></span>
<span><span class='va'>ds</span> <span class='op'>&lt;-</span> <span class='fu'>haven</span><span class='fu'>::</span><span class='fu'><a href='https://haven.tidyverse.org/reference/read_xpt.html'>read_xpt</a></span><span class='op'>(</span><span class='st'>"https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/DPQ_I.XPT"</span><span class='op'>)</span></span>
<span><span class='va'>ds</span> <span class='op'>&lt;-</span> <span class='va'>ds</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>11</span><span class='op'>]</span></span>
<span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>ds</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"q"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>ds</span><span class='op'>$</span><span class='va'>id</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span></span>
<span></span>
<span><span class='va'>ds</span> <span class='op'>&lt;-</span> <span class='va'>ds</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate_at</span><span class='op'>(</span><span class='fu'>vars</span><span class='op'>(</span><span class='va'>q1</span><span class='op'>:</span><span class='va'>q9</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>.</span> <span class='op'>&gt;</span> <span class='fl'>3</span>, <span class='cn'>NA</span>, <span class='va'>.</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>ds_dich</span> <span class='op'>&lt;-</span> <span class='va'>ds</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate_at</span><span class='op'>(</span><span class='fu'>vars</span><span class='op'>(</span><span class='va'>q1</span><span class='op'>:</span><span class='va'>q9</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>.</span> <span class='op'>&gt;</span> <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>qmeans</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>ds_dich</span>, <span class='fl'>2</span>, <span class='va'>mean</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>qmeans</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="IRT_and_CFA_files/figure-html5/loadData-1.png" width="624" /></p>
</div>
<p>This graph shows the mean number of endorsements an answer received. Here, we can see that q4 (“Feeling tired or having little energy”) had the most positive answers, while q9 (“Thought you would be better off dead”) had very few endorsements.</p>
<p>Before attempting to fit an IRT model, it would be good to examine whether the 9 items are all measuring the same latent variable. In our case, depression. This is done with a <em>scree test</em>, the components left of the “elbow” (the sharpest drop) of the graph should be retained. As we want to measure just 1 latent variable, we want there to be just 1 component before the elbow.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>screep</span> <span class='op'>&lt;-</span> <span class='fu'>fa.parallel</span><span class='op'>(</span><span class='va'>ds_dich</span>, cor <span class='op'>=</span> <span class='st'>"tet"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="IRT_and_CFA_files/figure-html5/unnamed-chunk-1-1.png" width="624" /></p>
<pre><code>Parallel analysis suggests that the number of factors =  4  and the number of components =  1 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>screep</span><span class='op'>$</span><span class='va'>fa.values</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>screep</span><span class='op'>$</span><span class='va'>fa.values</span>,</span>
<span>  type <span class='op'>=</span> <span class='st'>"b"</span>, pch <span class='op'>=</span> <span class='fl'>16</span>, col <span class='op'>=</span> <span class='st'>"blue"</span>,</span>
<span>  xlab <span class='op'>=</span> <span class='st'>"Factor Number"</span>,</span>
<span>  ylab <span class='op'>=</span> <span class='st'>"eigenvalues of factor analysis"</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Scree Plot"</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="IRT_and_CFA_files/figure-html5/unnamed-chunk-2-1.png" width="624" /></p>
</div>
<p>As shown, the scree plot suggests there is only 1 underlying factor. We can now proceed to fit the IRT models.</p>
<h2 id="fit-1pl-model">Fit 1PL Model</h2>
<p>Here, I fitted a 1PL (1-parameter logistic) model to estimate item difficulty based on how many people answered the items.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>pl1</span> <span class='op'>&lt;-</span> <span class='fu'>ltm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ltm/man/rasch.html'>rasch</a></span><span class='op'>(</span><span class='va'>ds_dich</span><span class='op'>)</span></span>
<span><span class='fu'>kable</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>pl1</span><span class='op'>)</span><span class='op'>$</span><span class='va'>coefficients</span>, digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">value</th>
<th style="text-align: right;">std.err</th>
<th style="text-align: right;">z.vals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dffclt.q1</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">32.27</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dffclt.q2</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">34.64</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dffclt.q3</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">16.86</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dffclt.q4</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">-3.17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dffclt.q5</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">32.27</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dffclt.q6</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">42.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dffclt.q7</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">42.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dffclt.q8</td>
<td style="text-align: right;">1.66</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">45.85</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dffclt.q9</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">45.52</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dscrmn</td>
<td style="text-align: right;">2.01</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">57.66</td>
</tr>
</tbody>
</table>
</div>
<p>Q1 has a difficulty score of 0.84. This refers to the fact that an individual with the “depression level” of 0.84 would have a 0.5 probability of endorsing Q1. Every item was fixed to have the same discrimination, which will be explained further on.</p>
<h2 id="fit-2pl-model">Fit 2PL Model</h2>
<p>Next, I fitted a 2PL model to estimate each item’s discrimination parameter. I will later graph this information, to better show what it means.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>pl2</span> <span class='op'>&lt;-</span> <span class='fu'>ltm</span><span class='op'>(</span><span class='va'>ds_dich</span> <span class='op'>~</span> <span class='va'>z1</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'>kable</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>pl2</span><span class='op'>)</span><span class='op'>$</span><span class='va'>coefficients</span>, digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">value</th>
<th style="text-align: right;">std.err</th>
<th style="text-align: right;">z.vals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dffclt.q1</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">29.56</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dffclt.q2</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">34.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dffclt.q3</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">16.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dffclt.q4</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">-2.93</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dffclt.q5</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">27.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dffclt.q6</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">39.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dffclt.q7</td>
<td style="text-align: right;">1.34</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">33.81</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dffclt.q8</td>
<td style="text-align: right;">1.69</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">33.75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dffclt.q9</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">31.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dscrmn.q1</td>
<td style="text-align: right;">2.07</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">24.34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dscrmn.q2</td>
<td style="text-align: right;">3.18</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">20.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dscrmn.q3</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">24.89</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dscrmn.q4</td>
<td style="text-align: right;">1.91</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">23.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dscrmn.q5</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">24.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dscrmn.q6</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">21.24</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dscrmn.q7</td>
<td style="text-align: right;">1.89</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">22.55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dscrmn.q8</td>
<td style="text-align: right;">1.94</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">20.29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dscrmn.q9</td>
<td style="text-align: right;">2.48</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">14.31</td>
</tr>
</tbody>
</table>
</div>
<p>Here, I test to see if 2PL model has a significantly better fit than 1PL model, by evaluating their model characteristics within an ANOVA. 2PL model has many more parameters, as seen by each question’s discrimination parameter. The ANOVA will compare the AIC’s of the two models, to see if the more complex model fits the data better.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>pl1</span>, <span class='va'>pl2</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
 Likelihood Ratio Table
         AIC      BIC   log.Lik    LRT df p.value
pl1 38038.94 38105.49 -19009.47                  
pl2 37849.45 37969.23 -18906.72 205.49  8  &lt;0.001</code></pre>
</div>
<p>The significant p-value in this chart tells us that the 2PL is a better fit to the data the 1PL. The fit of the model has been improved by estimating the discrimination parameter of each item, instead of fixing it to one value. If both models had fit the data similarly well, then the parsimony principle tells us that the simpler model should have been favored.</p>
<h2 id="item-characteristic-curves">Item Characteristic Curves</h2>
<p>Below, I plotted the item characteristic curves of the 10 items to better see the discriminability across items.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pl2</span>, type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ICC"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="IRT_and_CFA_files/figure-html5/unnamed-chunk-6-1.png" width="624" /></p>
</div>
<p>In the ICCs, we can better see the probability of endorsing an answer at varying ability levels. We see that q4 (the blue curve on the left; “Feeling tired or having little energy”) has a range of abilities endorsing it, while with q9 (the black curve on the right; “Thought you would be better off dead”), only individuals with the highest level of depression endorsed it. So, discrimination can be seen as the steepness of these curves.</p>
<h2 id="item-information-curves">Item Information Curves</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pl2</span>, type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"IIC"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="IRT_and_CFA_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<p>The IICs demonstrate that items range in how much information they provide about an individuals depression level for different ability levels. Item q10 (the red curve) gives us a the most information at moderate depression levels. In contrast, item q4 (the blue curve), gives us very low information because of how wide a range of depression levels it covers.</p>
<h2 id="sum-of-all-iic-curves">Sum of all IIC Curves</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pl2</span>, type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"IIC"</span><span class='op'>)</span>, items <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="IRT_and_CFA_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<p>The test information function shows that the items as a whole provide the most information about low-to-moderate depression levels, and less about extreme high or low depression levels. This is desirable, as it is not important to discriminate between those with very low or very high depression. It is important to discriminate between those of moderate depression levels, which is what the test information function tells us it does.</p>
<h2 id="confirmatory-factor-analysis-with-dichotomous-data">Confirmatory Factor Analysis with Dichotomous Data</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mod</span> <span class='op'>&lt;-</span></span>
<span>  <span class='st'>"depression =~ q1 + q2 + q3 + q4 + q5 +</span></span>
<span><span class='st'>                 q6 + q7 + q8 + q9</span></span>
<span><span class='st'></span></span>
<span><span class='st'>"</span></span>
<span></span>
<span></span>
<span><span class='va'>cfafit</span> <span class='op'>&lt;-</span> <span class='fu'>cfa</span><span class='op'>(</span><span class='va'>mod</span>,</span>
<span>  data <span class='op'>=</span> <span class='va'>ds_dich</span>,</span>
<span>  ordered <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"q1"</span>, <span class='st'>"q2"</span>, <span class='st'>"q3"</span>, <span class='st'>"q4"</span>, <span class='st'>"q5"</span>,</span>
<span>    <span class='st'>"q6"</span>, <span class='st'>"q7"</span>, <span class='st'>"q8"</span>, <span class='st'>"q9"</span></span>
<span>  <span class='op'>)</span>,</span>
<span>  estimator <span class='op'>=</span> <span class='st'>"WLSMV"</span>,</span>
<span>  check.gradient <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>cfafit</span>, fit.measures <span class='op'>=</span> <span class='cn'>TRUE</span>, standardized <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>lavaan 0.6.15 ended normally after 17 iterations

  Estimator                                       DWLS
  Optimization method                           NLMINB
  Number of model parameters                        18

                                                  Used       Total
  Number of observations                          5134        5735

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               269.518     404.621
  Degrees of freedom                                27          27
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.669
  Shift parameter                                            1.484
    simple second-order correction                                

Model Test Baseline Model:

  Test statistic                             28028.387   19894.317
  Degrees of freedom                                36          36
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.410

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.991       0.981
  Tucker-Lewis Index (TLI)                       0.988       0.975
                                                                  
  Robust Comparative Fit Index (CFI)                         0.901
  Robust Tucker-Lewis Index (TLI)                            0.868

Root Mean Square Error of Approximation:

  RMSEA                                          0.042       0.052
  90 Percent confidence interval - lower         0.037       0.048
  90 Percent confidence interval - upper         0.046       0.057
  P-value H_0: RMSEA &lt;= 0.050                    0.998       0.203
  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000
                                                                  
  Robust RMSEA                                               0.146
  90 Percent confidence interval - lower                     0.131
  90 Percent confidence interval - upper                     0.161
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.053       0.053

Parameter Estimates:

  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model        Unstructured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
  depression =~                                                
    q1                1.000                               0.765
    q2                1.160    0.022   52.372    0.000    0.887
    q3                0.890    0.023   39.502    0.000    0.681
    q4                0.965    0.022   43.802    0.000    0.738
    q5                0.877    0.023   38.143    0.000    0.671
    q6                1.106    0.022   49.387    0.000    0.846
    q7                0.956    0.024   39.331    0.000    0.731
    q8                0.946    0.027   35.642    0.000    0.723
    q9                1.020    0.033   31.139    0.000    0.780
  Std.all
         
    0.765
    0.887
    0.681
    0.738
    0.671
    0.846
    0.731
    0.723
    0.780

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
   .q1                0.000                               0.000
   .q2                0.000                               0.000
   .q3                0.000                               0.000
   .q4                0.000                               0.000
   .q5                0.000                               0.000
   .q6                0.000                               0.000
   .q7                0.000                               0.000
   .q8                0.000                               0.000
   .q9                0.000                               0.000
    depression        0.000                               0.000
  Std.all
    0.000
    0.000
    0.000
    0.000
    0.000
    0.000
    0.000
    0.000
    0.000
    0.000

Thresholds:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
    q1|t1             0.643    0.019   34.054    0.000    0.643
    q2|t1             0.709    0.019   36.944    0.000    0.709
    q3|t1             0.303    0.018   17.027    0.000    0.303
    q4|t1            -0.056    0.018   -3.182    0.001   -0.056
    q5|t1             0.640    0.019   33.946    0.000    0.640
    q6|t1             0.986    0.021   47.035    0.000    0.986
    q7|t1             0.989    0.021   47.130    0.000    0.989
    q8|t1             1.257    0.024   53.327    0.000    1.257
    q9|t1             1.782    0.032   54.885    0.000    1.782
  Std.all
    0.643
    0.709
    0.303
   -0.056
    0.640
    0.986
    0.989
    1.257
    1.782

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
   .q1                0.415                               0.415
   .q2                0.213                               0.213
   .q3                0.537                               0.537
   .q4                0.456                               0.456
   .q5                0.550                               0.550
   .q6                0.285                               0.285
   .q7                0.466                               0.466
   .q8                0.477                               0.477
   .q9                0.391                               0.391
    depression        0.585    0.019   30.385    0.000    1.000
  Std.all
    0.415
    0.213
    0.537
    0.456
    0.550
    0.285
    0.466
    0.477
    0.391
    1.000

Scales y*:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
    q1                1.000                               1.000
    q2                1.000                               1.000
    q3                1.000                               1.000
    q4                1.000                               1.000
    q5                1.000                               1.000
    q6                1.000                               1.000
    q7                1.000                               1.000
    q8                1.000                               1.000
    q9                1.000                               1.000
  Std.all
    1.000
    1.000
    1.000
    1.000
    1.000
    1.000
    1.000
    1.000
    1.000</code></pre>
</div>
<p>The thresholds of the CFA have a similar pattern to that of the difficulty ability of each item. Similarly, the factor loadings of the CFA seem similar to the discrimination parameters from the IRT.</p>
<h2 id="check-modification-indices">Check Modification Indices</h2>
<p>Next, I checked the modification indices for the assumption of <em>local independence</em> for any theoretical justification of adding covariances to the model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>modindices</span><span class='op'>(</span><span class='va'>cfafit</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>mi</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>  lhs op rhs     mi    epc sepc.lv sepc.all sepc.nox
1  q3 ~~  q4 77.087  0.172   0.172    0.348    0.348
2  q2 ~~  q6 52.803  0.143   0.143    0.581    0.581
3  q7 ~~  q8 29.487  0.138   0.138    0.292    0.292
4  q6 ~~  q9 28.424  0.154   0.154    0.462    0.462
5  q2 ~~  q3 28.022 -0.122  -0.122   -0.361   -0.361
6  q2 ~~  q4 21.572 -0.105  -0.105   -0.337   -0.337</code></pre>
</div>
<p>Some of the modification indices are high (e.g., <code>q2~~q6</code>), and the SEPC’s are moderate.</p>
<p>For example:</p>
<p>q3: “Trouble sleeping or sleeping too much”</p>
<p>q4: “Feeling tired or having little energy”</p>
<p>These seem to be closely related, though because this would be different to the IRT models, I won’t rerun the model with q3 and q4 added as covariances.</p>
<p>q2: “Feeling down, depressed, or hopeless”</p>
<p>q6: “Feeling bad about yourself”</p>
<p>Not closely related.</p>
<h2 id="compare-discriminations-with-factor-loadings">Compare discriminations with factor loadings</h2>
<p>Below I take a better look at the difference between my CFA’s factor loadings and 2PL’s discrimination abilities. To do this, I use a formula to transform IRT discrimination parameter estimates to standardized factor loadings <span class="citation" data-cites="cho2023">(<a href="#ref-cho2023" role="doc-biblioref">Cho 2023</a>)</span>: <span class="math display">\[\lambda = \frac{\alpha / D}{\sqrt{1 + (\alpha / D)}}  \]</span></p>
<p>Where alpha is the discrimination parameter, and <em>D</em> is a scaling constant which the author of the ltm package has chosen to be 1.702 <span class="citation" data-cites="rizopoulos2006">(<a href="#ref-rizopoulos2006" role="doc-biblioref">Rizopoulos 2006</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>model_loadings</span> <span class='op'>&lt;-</span> <span class='fu'>inspect</span><span class='op'>(</span><span class='va'>cfafit</span>, what <span class='op'>=</span> <span class='st'>"std"</span><span class='op'>)</span><span class='op'>[[</span><span class='st'>"lambda"</span><span class='op'>]</span><span class='op'>]</span></span>
<span></span>
<span><span class='va'>discrims</span> <span class='op'>&lt;-</span> <span class='va'>pl2</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span></span>
<span></span>
<span><span class='va'>D</span> <span class='op'>&lt;-</span> <span class='fl'>1.7</span></span>
<span></span>
<span><span class='va'>df_loadings</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span></span>
<span>  loadings <span class='op'>=</span> <span class='va'>model_loadings</span>,</span>
<span>  discrims_to_loadings <span class='op'>=</span> <span class='op'>(</span><span class='va'>discrims</span> <span class='op'>/</span> <span class='va'>D</span><span class='op'>)</span></span>
<span>  <span class='op'>/</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>discrims</span> <span class='op'>/</span> <span class='va'>D</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>df_loadings</span> <span class='op'>&lt;-</span> <span class='va'>df_loadings</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>cfa_loadings <span class='op'>=</span> <span class='va'>depression</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>df_loadings</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    dif <span class='op'>=</span> <span class='va'>cfa_loadings</span> <span class='op'>-</span> <span class='va'>discrims_to_loadings</span>,</span>
<span>    rat <span class='op'>=</span> <span class='va'>cfa_loadings</span> <span class='op'>/</span> <span class='va'>discrims_to_loadings</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
<pre><code>   cfa_loadings discrims_to_loadings          dif       rat
q1    0.7647710            0.7725016 -0.007730544 0.9899928
q2    0.8868587            0.8819424  0.004916318 1.0055744
q3    0.6807793            0.6777242  0.003055145 1.0045079
q4    0.7377550            0.7475920 -0.009836942 0.9868418
q5    0.6709435            0.6758790 -0.004935506 0.9926976
q6    0.8455697            0.8509317 -0.005361990 0.9936987
q7    0.7309156            0.7440796 -0.013163991 0.9823084
q8    0.7233743            0.7528095 -0.029435287 0.9608994
q9    0.7802641            0.8252215 -0.044957360 0.9455209</code></pre>
</div>
<p>Close! The values are close enough to have shown that for dichotomous data, CFA and 2PL IRT models are theoretically equivalent. The slight differences may be due to that this is only an approximation, and have slight rounding / computation errors; <span class="citation" data-cites="forero2009">(see <a href="#ref-forero2009" role="doc-biblioref">Forero and Maydeu-Olivares 2009</a>)</span>.</p>
<p>Everything done previously was on a dichotomized version of the data set. Next, I will compare two polytomous IRT models using the original data: the Graded Response Model (GRM) and Rating Scale Model (RSM).</p>
<h2 id="graded-response-model">Graded Response Model</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/warning.html'>suppressWarnings</a></span><span class='op'>(</span><span class='op'>{</span></span>
<span>  <span class='co'># Code generates "Warning: Nans produced" for every missing item</span></span>
<span>  <span class='va'>grm1</span> <span class='op'>&lt;-</span> <span class='fu'>ltm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ltm/man/grm.html'>grm</a></span><span class='op'>(</span><span class='va'>ds</span>, IRT.param <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span></span>
<span><span class='va'>grm1_coefs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>grm1</span><span class='op'>)</span><span class='op'>$</span><span class='va'>coefficients</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/row.names.html'>row.names</a></span><span class='op'>(</span><span class='va'>grm1_coefs</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Q"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>grm1_coefs</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'>kable</span><span class='op'>(</span><span class='va'>grm1_coefs</span>, digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Extrmt1</th>
<th style="text-align: right;">Extrmt2</th>
<th style="text-align: right;">Extrmt3</th>
<th style="text-align: right;">Dscrmn</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Q 1</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">1.76</td>
<td style="text-align: right;">2.28</td>
<td style="text-align: right;">1.98</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q 2</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">1.69</td>
<td style="text-align: right;">2.19</td>
<td style="text-align: right;">3.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q 3</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">1.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q 4</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">1.87</td>
<td style="text-align: right;">1.91</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q 5</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">1.92</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">1.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q 6</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">1.88</td>
<td style="text-align: right;">2.33</td>
<td style="text-align: right;">2.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q 7</td>
<td style="text-align: right;">1.29</td>
<td style="text-align: right;">2.06</td>
<td style="text-align: right;">2.51</td>
<td style="text-align: right;">2.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q 8</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: right;">2.44</td>
<td style="text-align: right;">2.91</td>
<td style="text-align: right;">1.90</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q 9</td>
<td style="text-align: right;">2.21</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">3.22</td>
<td style="text-align: right;">2.46</td>
</tr>
</tbody>
</table>
</div>
<p>Examining the output, two things are immediately apparent. There are 3 extremity parameters; one for each of the 3 possible levels of endorsement of 1, 2, or 3. The <em>Extrmt1</em> values are roughly equivalent to the 2PL model’s difficulty parameter values. This is expected, as the <em>Extrmt1</em> scores refer to the “depression level” an individual would need to have a 50/50 chance of selecting a 1 (In the dichotomous IRT, an endorsement) for that item. Extrt3 scores refer to the trait level an individual would need to have a 50/50 chance of selecting not only a 1, but also a 2 or 3. Polytomous IRT models give more information than dichotomous, where we discard these other probabilities. Because the GRM has more information, it’s discrimination parameters are sightly different to the discrimination parameters of the 2PL model.</p>
<h2 id="item-characteristic-and-item-information-curves">Item Characteristic and Item Information Curves</h2>
<p>Much the same as with the 2PL Model, I plotted the ICCs to get a better view of the discrimination and difficulty of each question. For this, I chose to plot only the ICCs of items 2 and 5, each having the largest difference in discriminations (3.010 for item 2, and 1.637 for item 5).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>grm1</span>, type <span class='op'>=</span> <span class='st'>"IIC"</span>, zrange <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<img src="IRT_and_CFA_files/figure-html5/unnamed-chunk-13-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>grm1</span>,</span>
<span>  type <span class='op'>=</span> <span class='st'>"ICC"</span>, items <span class='op'>=</span> <span class='fl'>2</span>, zrange <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Item Characteristic Curves - Item: q2"</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
<img src="IRT_and_CFA_files/figure-html5/unnamed-chunk-13-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>grm1</span>,</span>
<span>  type <span class='op'>=</span> <span class='st'>"ICC"</span>, items <span class='op'>=</span> <span class='fl'>5</span>, zrange <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Item Characteristic Curves - Item: q5"</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="IRT_and_CFA_files/figure-html5/unnamed-chunk-13-3.png" width="624" /></p>
</div>
<p>The discrimination parameter acts as the slope of the curves, so the response categories of item 2 (with a very high discrimination) all have a very steep slope. The response categories of item 5 (a low discrimination) have a very shallow slope.</p>
<p>For each item: As ability (level of depression) increases, the probability of selecting response category 1, “Not at all”, decreases. And for response category 4, “nearly everyday”, it’s vice versa. This is expected, as someone without depression would easily select “not at all” for many of the questions, it’s only if they have some level of depression they would start endorsing a higher category.</p>
<h2 id="pl-and-grm-test-information-function">2PL and GRM Test Information Function</h2>
<p>The Test Information Function best shows what information was lost when I dichotomized the data for the 2PL</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>pl2_TIF</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pl2</span>,</span>
<span>  type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"IIC"</span><span class='op'>)</span>,</span>
<span>  items <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>,</span>
<span>  col <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>15</span><span class='op'>)</span>,</span>
<span>  xlab <span class='op'>=</span> <span class='st'>"Depression"</span></span>
<span><span class='op'>)</span></span>
<span><span class='va'>grm_TIF</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>grm1</span>, type <span class='op'>=</span> <span class='st'>"IIC"</span>, items <span class='op'>=</span> <span class='fl'>0</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>grm_TIF</span>, col <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"topleft"</span>, legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GRM"</span>, <span class='st'>"2PL"</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>, <span class='st'>"red"</span><span class='op'>)</span>, lty <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="IRT_and_CFA_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<p>Up until a low-moderate depression level, both the dichotomous and polytomous IRT yielded the same information. GRM gives more information about the more severely depressed people, which you lose if you just ask, “Do you have any symptoms?” (essentially what the dichotomized data was).</p>
<h2 id="rating-scale-model">Rating Scale Model</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>rsm1</span> <span class='op'>&lt;-</span> <span class='fu'>TAM</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/TAM/man/tam.mml.html'>tam.mml</a></span><span class='op'>(</span><span class='va'>ds</span>, irtmodel <span class='op'>=</span> <span class='st'>"RSM"</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'>kable</span><span class='op'>(</span><span class='va'>rsm1</span><span class='op'>$</span><span class='va'>item</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>7</span><span class='op'>]</span>, digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">item</th>
<th style="text-align: right;">N</th>
<th style="text-align: right;">M</th>
<th style="text-align: right;">xsi.item</th>
<th style="text-align: right;">AXsi_.Cat1</th>
<th style="text-align: right;">AXsi_.Cat2</th>
<th style="text-align: right;">AXsi_.Cat3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">q1</td>
<td style="text-align: left;">q1</td>
<td style="text-align: right;">5151</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: right;">4.09</td>
<td style="text-align: right;">6.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">q2</td>
<td style="text-align: left;">q2</td>
<td style="text-align: right;">5161</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">2.25</td>
<td style="text-align: right;">1.81</td>
<td style="text-align: right;">4.49</td>
<td style="text-align: right;">6.75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">q3</td>
<td style="text-align: left;">q3</td>
<td style="text-align: right;">5161</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">3.02</td>
<td style="text-align: right;">4.55</td>
</tr>
<tr class="even">
<td style="text-align: left;">q4</td>
<td style="text-align: left;">q4</td>
<td style="text-align: right;">5161</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">2.33</td>
<td style="text-align: right;">3.51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">q5</td>
<td style="text-align: left;">q5</td>
<td style="text-align: right;">5158</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">2.06</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">4.11</td>
<td style="text-align: right;">6.18</td>
</tr>
<tr class="even">
<td style="text-align: left;">q6</td>
<td style="text-align: left;">q6</td>
<td style="text-align: right;">5159</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">2.65</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">5.28</td>
<td style="text-align: right;">7.94</td>
</tr>
<tr class="odd">
<td style="text-align: left;">q7</td>
<td style="text-align: left;">q7</td>
<td style="text-align: right;">5159</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">2.15</td>
<td style="text-align: right;">5.17</td>
<td style="text-align: right;">7.78</td>
</tr>
<tr class="even">
<td style="text-align: left;">q8</td>
<td style="text-align: left;">q8</td>
<td style="text-align: right;">5158</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">3.09</td>
<td style="text-align: right;">2.65</td>
<td style="text-align: right;">6.17</td>
<td style="text-align: right;">9.28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">q9</td>
<td style="text-align: left;">q9</td>
<td style="text-align: right;">5157</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">4.21</td>
<td style="text-align: right;">3.77</td>
<td style="text-align: right;">8.41</td>
<td style="text-align: right;">12.63</td>
</tr>
</tbody>
</table>
</div>
<p>The difficulties, from the “AXsi_.Cat1, AXsi_.Cat2, and AXsi_.Cat3” columns, while seemingly scaled differently, show the expected values. Q9 has the highest difficulty, and Q4 has the lowest. There are no discrimination parameters, which lowers the complexity of the model quite a bit. Next, I will graph the Item Characteristic Curves to better see what this constrained discriminatory parameter looks like.</p>
<h2 id="rsm-item-characteristic-curves">RSM: Item Characteristic Curves</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rsm1</span>,</span>
<span>  type <span class='op'>=</span> <span class='st'>"items"</span>,</span>
<span>  export <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>  package <span class='op'>=</span> <span class='st'>"graphics"</span>,</span>
<span>  observed <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>  low <span class='op'>=</span> <span class='op'>-</span><span class='fl'>6</span>,</span>
<span>  high <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  items <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>5</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Iteration in WLE/MLE estimation  1   | Maximal change  2.9707 
Iteration in WLE/MLE estimation  2   | Maximal change  2.8242 
Iteration in WLE/MLE estimation  3   | Maximal change  1.577 
Iteration in WLE/MLE estimation  4   | Maximal change  0.4525 
Iteration in WLE/MLE estimation  5   | Maximal change  0.1469 
Iteration in WLE/MLE estimation  6   | Maximal change  0.0165 
Iteration in WLE/MLE estimation  7   | Maximal change  6e-04 
Iteration in WLE/MLE estimation  8   | Maximal change  0 
----
 WLE Reliability= 0.412 </code></pre>
<p><img src="IRT_and_CFA_files/figure-html5/unnamed-chunk-16-1.png" width="624" /><img src="IRT_and_CFA_files/figure-html5/unnamed-chunk-16-2.png" width="624" /></p>
</div>
<p>Interesting! The RSM would have us believe that Q2 and Q5 are extremely similar, even while they differ wildly in how discriminating they are. Next, I plot it’s test information curve with the 2PL and GRM models.</p>
<h2 id="rsm-test-information-curve">RSM: Test Information Curve</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>rsm1_TIF</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>IRT.informationCurves</span><span class='op'>(</span><span class='va'>rsm1</span><span class='op'>)</span>,</span>
<span>  col <span class='op'>=</span> <span class='st'>"green"</span>,</span>
<span>  xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>4</span>, <span class='fl'>6</span><span class='op'>)</span>,</span>
<span>  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>15</span><span class='op'>)</span>,</span>
<span>  ylab <span class='op'>=</span> <span class='st'>"Information"</span>,</span>
<span>  xlab <span class='op'>=</span> <span class='st'>"Depression"</span></span>
<span><span class='op'>)</span></span>
<span><span class='va'>pl2_TIF</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pl2</span>, type <span class='op'>=</span> <span class='st'>"IIC"</span>, items <span class='op'>=</span> <span class='fl'>0</span>, zrange <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>4</span>, <span class='fl'>6</span><span class='op'>)</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span><span class='va'>grm_TIF</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>grm1</span>, type <span class='op'>=</span> <span class='st'>"IIC"</span>, items <span class='op'>=</span> <span class='fl'>0</span>, zrange <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>4</span>, <span class='fl'>6</span><span class='op'>)</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>grm_TIF</span>, col <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>pl2_TIF</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"topleft"</span>,</span>
<span>  legend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GRM"</span>, <span class='st'>"2PL"</span>, <span class='st'>"RSM"</span><span class='op'>)</span>,</span>
<span>  col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>, <span class='st'>"red"</span>, <span class='st'>"green"</span><span class='op'>)</span>,</span>
<span>  lty <span class='op'>=</span> <span class='fl'>1</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="IRT_and_CFA_files/figure-html5/unnamed-chunk-17-1.png" width="624" /></p>
</div>
<p>This may not be accurate, as I don’t know how the TAM package creates the Test Information Curve. With that, it’s noteworthy how much more information the GRM gives compared to the RSM. Again, this may be different if the discrimination parameters of the questions weren’t so different.</p>
<h2 id="log-likelihood-and-aic-of-grm-and-rsm">Log-Likelihood and AIC of GRM and RSM</h2>
<p>Because GRM is the more complex model, I expect it to have a larger Log-likelihood. However, it should be a better fit due to the added discrimination abilities giving the model more information (as I’ve shown with the Test Information Function), which a lower AIC would signify.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>comparison</span> <span class='op'>&lt;-</span> <span class='fu'>IRT.compareModels</span><span class='op'>(</span><span class='va'>grm1</span>, <span class='va'>rsm1</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>comparison</span>, extended <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Absolute and relative model fit

  Model   loglike Deviance Npars Nobs      AIC      BIC     AIC3
1  grm1 -27895.93 55791.85    36 5735 55863.85 56103.41 55899.85
2  rsm1 -28752.26 57504.52    12 5164 57528.52 57607.11 57540.52
        GHP
1 -27895.93
2      0.62

Likelihood ratio tests - model comparison 

  Model1 Model2     Chi2 df p
1   rsm1   grm1 1712.665 24 0</code></pre>
</div>
<p>Comparing the AIC’s of each model, the Graded Response Model is the better fit. If the discriminatory parameters of the GRM were all very similar, then the RSM may have been a better fit due to the lower complexity.</p>
<h2 id="confirmatory-factor-analysis-with-polytomous-data">Confirmatory Factor Analysis with Polytomous Data</h2>
<p>Here, I fit a CFA with the original, polytomous data. This should be very close to the GRM, now that it is using the same data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mod2</span> <span class='op'>&lt;-</span></span>
<span>  <span class='st'>"depression =~ q1 + q2 + q3 + q4 + q5 +</span></span>
<span><span class='st'>                 q6 + q7 + q8 + q9</span></span>
<span><span class='st'>"</span></span>
<span></span>
<span></span>
<span><span class='va'>cfafit2</span> <span class='op'>&lt;-</span> <span class='fu'>cfa</span><span class='op'>(</span><span class='va'>mod2</span>,</span>
<span>  data <span class='op'>=</span> <span class='va'>ds</span>,</span>
<span>  ordered <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"q1"</span>, <span class='st'>"q2"</span>, <span class='st'>"q3"</span>, <span class='st'>"q4"</span>, <span class='st'>"q5"</span>,</span>
<span>    <span class='st'>"q6"</span>, <span class='st'>"q7"</span>, <span class='st'>"q8"</span>, <span class='st'>"q9"</span></span>
<span>  <span class='op'>)</span>,</span>
<span>  estimator <span class='op'>=</span> <span class='st'>"WLSMV"</span>,</span>
<span>  check.gradient <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>cfafit2</span>, fit.measures <span class='op'>=</span> <span class='cn'>TRUE</span>, standardized <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>lavaan 0.6.15 ended normally after 17 iterations

  Estimator                                       DWLS
  Optimization method                           NLMINB
  Number of model parameters                        36

                                                  Used       Total
  Number of observations                          5134        5735

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               325.090     583.771
  Degrees of freedom                                27          27
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.559
  Shift parameter                                            2.037
    simple second-order correction                                

Model Test Baseline Model:

  Test statistic                             41255.954   23189.999
  Degrees of freedom                                36          36
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.780

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.993       0.976
  Tucker-Lewis Index (TLI)                       0.990       0.968
                                                                  
  Robust Comparative Fit Index (CFI)                         0.925
  Robust Tucker-Lewis Index (TLI)                            0.900

Root Mean Square Error of Approximation:

  RMSEA                                          0.046       0.063
  90 Percent confidence interval - lower         0.042       0.059
  90 Percent confidence interval - upper         0.051       0.068
  P-value H_0: RMSEA &lt;= 0.050                    0.902       0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000
                                                                  
  Robust RMSEA                                               0.124
  90 Percent confidence interval - lower                     0.113
  90 Percent confidence interval - upper                     0.136
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.045       0.045

Parameter Estimates:

  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model        Unstructured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
  depression =~                                                
    q1                1.000                               0.738
    q2                1.174    0.020   59.412    0.000    0.866
    q3                0.940    0.020   45.940    0.000    0.693
    q4                1.002    0.018   55.103    0.000    0.739
    q5                0.912    0.021   44.119    0.000    0.673
    q6                1.148    0.020   57.410    0.000    0.847
    q7                1.009    0.022   46.399    0.000    0.744
    q8                0.966    0.026   37.308    0.000    0.712
    q9                1.091    0.030   36.901    0.000    0.804
  Std.all
         
    0.738
    0.866
    0.693
    0.739
    0.673
    0.847
    0.744
    0.712
    0.804

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
   .q1                0.000                               0.000
   .q2                0.000                               0.000
   .q3                0.000                               0.000
   .q4                0.000                               0.000
   .q5                0.000                               0.000
   .q6                0.000                               0.000
   .q7                0.000                               0.000
   .q8                0.000                               0.000
   .q9                0.000                               0.000
    depression        0.000                               0.000
  Std.all
    0.000
    0.000
    0.000
    0.000
    0.000
    0.000
    0.000
    0.000
    0.000
    0.000

Thresholds:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
    q1|t1             0.643    0.019   34.054    0.000    0.643
    q1|t2             1.313    0.024   54.152    0.000    1.313
    q1|t3             1.691    0.030   55.561    0.000    1.691
    q2|t1             0.709    0.019   36.944    0.000    0.709
    q2|t2             1.471    0.026   55.614    0.000    1.471
    q2|t3             1.875    0.035   53.823    0.000    1.875
    q3|t1             0.303    0.018   17.027    0.000    0.303
    q3|t2             1.040    0.021   48.581    0.000    1.040
    q3|t3             1.399    0.025   55.116    0.000    1.399
    q4|t1            -0.056    0.018   -3.182    0.001   -0.056
    q4|t2             0.939    0.021   45.584    0.000    0.939
    q4|t3             1.378    0.025   54.911    0.000    1.378
    q5|t1             0.640    0.019   33.946    0.000    0.640
    q5|t2             1.327    0.024   54.333    0.000    1.327
    q5|t3             1.689    0.030   55.572    0.000    1.689
    q6|t1             0.986    0.021   47.035    0.000    0.986
    q6|t2             1.604    0.029   55.863    0.000    1.604
    q6|t3             1.945    0.037   52.812    0.000    1.945
    q7|t1             0.989    0.021   47.130    0.000    0.989
    q7|t2             1.553    0.028   55.872    0.000    1.553
    q7|t3             1.853    0.034   54.107    0.000    1.853
    q8|t1             1.257    0.024   53.327    0.000    1.257
    q8|t2             1.789    0.033   54.815    0.000    1.789
    q8|t3             2.103    0.042   49.893    0.000    2.103
    q9|t1             1.782    0.032   54.885    0.000    1.782
    q9|t2             2.231    0.047   47.032    0.000    2.231
    q9|t3             2.521    0.064   39.365    0.000    2.521
  Std.all
    0.643
    1.313
    1.691
    0.709
    1.471
    1.875
    0.303
    1.040
    1.399
   -0.056
    0.939
    1.378
    0.640
    1.327
    1.689
    0.986
    1.604
    1.945
    0.989
    1.553
    1.853
    1.257
    1.789
    2.103
    1.782
    2.231
    2.521

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
   .q1                0.456                               0.456
   .q2                0.251                               0.251
   .q3                0.519                               0.519
   .q4                0.454                               0.454
   .q5                0.547                               0.547
   .q6                0.283                               0.283
   .q7                0.446                               0.446
   .q8                0.493                               0.493
   .q9                0.353                               0.353
    depression        0.544    0.017   31.727    0.000    1.000
  Std.all
    0.456
    0.251
    0.519
    0.454
    0.547
    0.283
    0.446
    0.493
    0.353
    1.000

Scales y*:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv
    q1                1.000                               1.000
    q2                1.000                               1.000
    q3                1.000                               1.000
    q4                1.000                               1.000
    q5                1.000                               1.000
    q6                1.000                               1.000
    q7                1.000                               1.000
    q8                1.000                               1.000
    q9                1.000                               1.000
  Std.all
    1.000
    1.000
    1.000
    1.000
    1.000
    1.000
    1.000
    1.000
    1.000</code></pre>
</div>
<h2 id="compare-discrimination-parameter-of-grm-and-factor-loadings-of-polytomous-cfa">Compare Discrimination Parameter of GRM and Factor Loadings of Polytomous CFA</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>model_loadings_poly</span> <span class='op'>&lt;-</span> <span class='fu'>inspect</span><span class='op'>(</span><span class='va'>cfafit2</span>, what <span class='op'>=</span> <span class='st'>"std"</span><span class='op'>)</span><span class='op'>[[</span><span class='st'>"lambda"</span><span class='op'>]</span><span class='op'>]</span></span>
<span></span>
<span><span class='va'>discrims_poly</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>9</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>discrims_poly</span><span class='op'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"q"</span>, <span class='va'>i</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>grm1</span><span class='op'>)</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"q"</span>, <span class='va'>i</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>discrims_poly</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>discrims_poly</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>discrims_poly</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>discrims_poly</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>D</span> <span class='op'>&lt;-</span> <span class='fl'>1.7</span></span>
<span></span>
<span><span class='va'>df_loadings_poly</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span></span>
<span>  loadings <span class='op'>=</span> <span class='va'>model_loadings_poly</span>,</span>
<span>  discrims_to_loadings <span class='op'>=</span> <span class='op'>(</span><span class='va'>discrims_poly</span> <span class='op'>/</span> <span class='va'>D</span><span class='op'>)</span></span>
<span>  <span class='op'>/</span></span>
<span>    <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>discrims_poly</span> <span class='op'>/</span> <span class='va'>D</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>df_loadings_poly</span> <span class='op'>&lt;-</span> <span class='va'>df_loadings_poly</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>cfa_loadings <span class='op'>=</span> <span class='va'>depression</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>df_loadings_poly</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    dif <span class='op'>=</span> <span class='va'>cfa_loadings</span> <span class='op'>-</span> <span class='va'>discrims_to_loadings</span>,</span>
<span>    rat <span class='op'>=</span> <span class='va'>cfa_loadings</span> <span class='op'>/</span> <span class='va'>discrims_to_loadings</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
<pre><code>   cfa_loadings discrims_to_loadings          dif       rat
q1    0.7375195            0.7584342 -0.020914731 0.9724238
q2    0.8655098            0.8707365 -0.005226748 0.9939973
q3    0.6932849            0.6944226 -0.001137694 0.9983617
q4    0.7391335            0.7461941 -0.007060588 0.9905379
q5    0.6728642            0.6935380 -0.020673861 0.9701907
q6    0.8466470            0.8549768 -0.008329818 0.9902573
q7    0.7441284            0.7615307 -0.017402315 0.9771482
q8    0.7121545            0.7444280 -0.032273496 0.9566466
q9    0.8042705            0.8224679 -0.018197394 0.9778746</code></pre>
</div>
<p>Almost equivalent. The values are close enough to have shown that for unidimensional polytomous data, CFA and the GRM are theoretically equivalent.<br />
</p>
<h2 id="conclusion">Conclusion</h2>
<p>The IRT analysis showed that the questions were all positive, that the discrimination parameters were all good, that the IIC suggests that the scale is overall reliable, but the reliability peaks on low-moderate depression. But in a screening tool, this is probably what we want.</p>
<p>The factor analysis gave extremely similar results to the IRT analysis, theoretically identical. However, the model fit was not perfect, suggesting that it was not uni-dimensional, which might be a problem. The modification indices suggested some additional covariances, but I didn’t as it would be no longer equivalent to the IRT.</p>
<p>Also, the fact that I can add covariances to the CFA leads me to believe that CFA is the more flexible model. The IRT models did however yield more interpretable results, and in that way seem specialized for uni-dimensional testing. CFA has a much wider application of uses (i.e., multivariate systems) and seems to focus on the relationship between variables.</p>
<p>I wanted to try running a CFA using Maximum Likelihood, however the model would not converge when the estimator was “MML”. This would have allowed me to use the <code>AIC()</code> function to compare my CFA models to the IRT models. Instead, I compared the factor loadings and discrimination parameters. This showed that the CFA is largely equivalent to an IRT model when using the same data.</p>
<p>Comparing the RSM and the GRM, the GRM was a better fit. This was due to the fact that the questions all had different discriminatory parameters, something that the RSM does not calculate (and for that reason, took much less time to run).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-cho2023" class="csl-entry" role="listitem">
Cho, Eunseong. 2023. <span>“Interchangeability Between Factor Analysis, Logistic IRT, and Normal Ogive IRT.”</span> <em>Frontiers in Psychology</em> 14 (September). <a href="https://doi.org/10.3389/fpsyg.2023.1267219">https://doi.org/10.3389/fpsyg.2023.1267219</a>.
</div>
<div id="ref-forero2009" class="csl-entry" role="listitem">
Forero, Carlos G., and Alberto Maydeu-Olivares. 2009. <span>“Estimation of IRT Graded Response Models: Limited Versus Full Information Methods.”</span> <em>Psychological Methods</em> 14 (3): 275–99. <a href="https://doi.org/10.1037/a0015825">https://doi.org/10.1037/a0015825</a>.
</div>
<div id="ref-rizopoulos2006" class="csl-entry" role="listitem">
Rizopoulos, Dimitris. 2006. <span>“Ltm: An R Package for Latent Variable Modeling and Item Response Theory Analyses.”</span> <em>Journal of Statistical Software</em> 17 (5). <a href="https://doi.org/10.18637/jss.v017.i05">https://doi.org/10.18637/jss.v017.i05</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Miles (2024, April 22). Measurement &amp; Multilevel Modeling Lab: IRT and CFA. Retrieved from https://mmmlab.rbind.io/posts/2024-04-22-cfa-vs-irt/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{miles2024irt,
  author = {Miles, Alex},
  title = {Measurement &amp; Multilevel Modeling Lab: IRT and CFA},
  url = {https://mmmlab.rbind.io/posts/2024-04-22-cfa-vs-irt/},
  year = {2024}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© 2021 Measurement &amp; Multilevel Modeling Lab</p>
<p>Powered by
<a href="https://github.com/distillpub/template/blob/master/AUTHORS">The
Distill Template Authors</a> and
<a href="https://www.rstudio.com">Rstudio, Inc</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
