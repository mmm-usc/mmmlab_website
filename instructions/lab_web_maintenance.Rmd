---
title: "MMM Lab Website Maintenance Routine"
author: "Winnie Wing-Yee Tse"
date: "2/27/2021"
output:
  html_document:
    toc: yes
    toc_depth: 3
---

***

# Setup

## Once and for all setup

### Cloning a Git Repository

- Open Rstudio on your computer. If you don't have Rstudio, please download it from [here](https://rstudio.com/products/rstudio/download/#download).

- Go to "File" > "New Project". In the popped-up window, select "Version Control" > "Git", put "https://github.com/winniewytse/mmmlab_website.git" under "Repository URL", and press "Create Project".
    - You can change the directory (location) of this project under "Create project as subdirectory of:" at "Browse...". 

![](../lab_website_maintenance/images/new_project.png)
![](../lab_website_maintenance/images/version_control.png)

![](../lab_website_maintenance/images/git.png)

![](../lab_website_maintenance/images/clone_git_repo.png)

- There you go! You now have everything that is up on the remote Git repository on your local repository.

### Install Packages

- Install necessary packages by running the following in your console

```{r eval=FALSE}
install.packages(c("distill", "RefManageR", "bibtex"))
```

***

## Recurrent setup

### "Pull", "Commit", "Push" Habits

To avoid conflicts from your and others' changes on the website files, a good habit is to first **pull** files from Github before starting to make changes and to **commit** and **push** your changes right after you finished making changes. 

- Every time before you start working on your local repository, remember to first **pull** the content from the remote repository. This makes sure that your local repository is up-to-date to the changes someone else might have made. 

    - Click on the blue downward arrow under the "Git" tab and make sure, from the popped-up window, you get the "Already up to date" (or similar) message. If you do, then you can proceed to make changes in the files. 

![](../lab_website_maintenance/images/pull.png)

![](../lab_website_maintenance/images/already_up_to_date.png)

- Every time after you made changes on your local repository, remember to 
    a. **commit** the changes by clicking on "Commit" under "Git", checking all changed files, typing in a "Commit message", and sending "Commit", and
    b. click on the green upward arrow to **push** your changes to the remote repository.
  
![](../lab_website_maintenance/images/commit.png)
![](../lab_website_maintenance/images/commit2.png)

![](../lab_website_maintenance/images/push.png)
This allows sharing the changes you made in your local repository to the Github repository. After successfully committing and pushing changes, you are good to go for the updates you just made :)

### Branches

Our Git repository contains multiple branches, analogous to having different versions of the website. The older versions of our website are stored under other branches (e.g., `devel_ml`). This is one way to avoid conflicts of changes among collaborators on Github. 

Our work distribution will be you being in charge of the `distill` branch to incorporate new materials (e.g., blog posts and publications) from our lab members and me being responsible of confirming with your changes and merging them to the `master` branch from which the actual website is built upon. In that way, you could be worry-free of making any mistakes that might potentially break some links or features (that could happen all the time) in the `distill` branch because they are not directly applied to the published website. We will have time to troubleshoot and can always revert back to where we started by adopting the content in the `master` branch. 

Before you make any changes in the files, **make sure that you are in the `distill` branch**. To switch between branches, under "Git", click on the name of the current branch (in the picture: `distill`). From the drop-down menu, select the branch you want to work with. 

![](../lab_website_maintenance/images/branch.png)

Most of the time I will not work on the `distill` branch. But if I do, I will confirm with you that you have committed and pushed all your changes to Github beforehand. I will also let you know once I'm done editing, such that you can pull the changes I made to your local repository and continue editing. 


***

# Preview Changes

To preview the website, click on "Build Website" under "Build. 

![](../lab_website_maintenance/images/build_site.png)

Under "Viewer", we can preview the mobile-sized version of the website. You can also open up a desktop-sized version of the website by clicking on the "Show in new window" button (circled in red down below). 

![](../lab_website_maintenance/images/viewer.png)


***

# Major Maintenance Tasks

## (1) Profiles of Lab Members

- File to update: `members.Rmd`

This page contains the profile of our lab members, including our principal investigator, graduate students, undergraduate students, and collaborators. The content of a profile may include, a short bio, a CV, a link to a personal website, and an email address of a lab member. Your responsibility includes collecting this information from our lab members and updating it on the website. 

### R Markdown Syntax

Some essential R Markdown syntax is common on this page (and others as well). 

#### 1. Headers
![](../lab_website_maintenance/images/header.png)

#### 2. Bold / italicize
  - `**bold**`, **bold**
  - `*italics*`, *italics*
  
#### 3. List
![](../lab_website_maintenance/images/list.png)

#### 4. Horizontal rule
  - To divide up sections, use a horizontal rule `***`
  
#### 5. Hyperlinks
  - CVs
      - If you receive a new / an updated CV, place that file in the folder "static", "cv". 
      - To hyperlink someone's CV to the word "CV" in `publication.Rmd`: `[CV](static/cv/file name)`
      
![](../lab_website_maintenance/images/static.png)
![](../lab_website_maintenance/images/cv.png)

  - Image
      - If you receive a new picture, place that picture in the folder "static", "images". 
      - To hyperlink a picture: `![alt text](static/images/filename)`
          - I encourage you to include an alternative text in the square brackets every time you add a new picture. The text briefly describes the picture (e.g., `![MMM Lab Members](static/images/mmm_members_20201124.png)`; see this example under `about.Rmd`). 
          - The alternative text will not appear on the webpage unless the link is broken, which may occur occasionally. It allows others to recognize the content of the picture even with a broken link. 
      - If you receive an external link to a picture, you can create a code chunk by pressing `Command + Shift + i` for mac users or `Ctrl + Shift + i` for Windows users and use the command `knitr::include_graphics("link")` in the code chunk. See below as an example. 

![](../lab_website_maintenance/images/images.png)

```{r eval=FALSE}
knitr::include_graphics("https://quantscience.rbind.io/author/hok-chio-mark-lai-%E9%BB%8E%E5%AD%B8%E6%98%AD/avatar_hu5fee5d8532847d51fbb6966683aaaac0_71984_270x270_fill_q90_lanczos_center.jpg")
```

  - External links to a webpage
      - `[text](link)`
      - Texts within the square brackets will appear on the webpage while the link will not. Clicking on the texts will get us to the external webpage. 
  
If you are interested in learning more Markdown syntax, please visit this [cheatsheet](https://rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf). 


***

## (2) Publications

- File to update: `publication.Rmd`

From time to time, you will receive information of our lab members' latest publication. They may be (1) already published articles with a DOI, (2) accepted or in press articles, and (3) conference presentations. 

1. For published articles with a DOI (e.g., "10.1016/j.addbeh.2018.11.029"), in the command of `RefManageR::GetBibEntryWithDOI()`, add the DOI in a new line. For example, 
    
```{r eval=FALSE}
RefManageR::GetBibEntryWithDOI(
  unique(
    c("10.1080/10705511.2020.1782206", 
      "10.1037/met0000287", 
      "10.1080/00273171.2020.1746902", 
      "10.3102/1076998619843168", 
      "10.1016/j.addbeh.2018.11.029") # new DOI added here
  ), 
  temp.file = "pubs.bib", 
  delete.file = FALSE)
```

2. For unpublished but accepted articles without a DOI, manually input the details of the article using `BibEntry()` and save it to `ref`. For example, 

```{r eval=FALSE}
ref <- c(
  BibEntry(
    bibtype = "unpublished", 
    key = "lai2021", 
    title = "Adjusting for partial invariance in latent parameter estimation: Comparing forward specification search and approximate invariance methods", 
    author = "Lai, Mark H. C. and Liu, Yuanfang and Tse, Winnie Wing-Yee", 
    year = "2021", 
    journal = "Behavior Research Methods", 
    date = "2021-02-05", 
    pubstate = "Manuscript accepted for publication"
  ), 
  BibEntry(
    bibtype = "unpublished", 
    key = "firstauthor_year", 
    title = "article name", 
    author = "author 1 last name, first name and author 2 last name, first name, etc.", 
    year = "year", 
    journal = "journal name", 
    date = "date accepted", # optional
    pubstate = "Manuscript accepted for publication"
  )
  # add more down below
)
```

3. For conference presentations, we currently need to manually format their citations (I may customize a `bibtype` later in time). The format is as follows:
  
    - Authors (year, month dates). *Conference presentation title* [Paper Session/Poster Session/Symposium/etc.]. Conference name, Location, States, Coutnry. `[Schedule/Powerpoint slides](link)`. 
    

***

## (3) Blog Posts

- Folder to update: `_posts`

You will usually receive an R Markdwon file (`.Rmd`) or a Markdown file (`.md`) with the materials to be published. If it is `.md` file which contains pictures, make sure that you have also received a folder `figures` for the pictures; otherwise, please request for that folder from the sender. 

To create a blog post on the lab website with `distill`, 

1.  make sure you have load the `distill` package (see below), and
2.  run `create_post("blog post name")`. 

In your console, run

```{r eval=FALSE}
library(distill)
create_post("new post")
```

- A new folder (e.g., "2021-03-01-new-post") will be created in "_posts" with an `.Rmd` file (`new-post.Rmd`) in it. 

3. Copy and paste the content from the sender's `.Rmd` or `.md` file to the body of the newly created `.Rmd` (`new-post.Rmd`). 

4. Change the yaml metadata of the `.Rmd` file (i.e., `title`, `description`, `author`, `date`, and `categories`) at the top of the document. Below shows a template. 

```{r eval=FALSE}
title: "Exploring the UAS Survey Part 1: Data exploration (Demography and Risk Items)"
description: |
  Analyze Covid-19 survey conducted by USC in March, 2020.
author:
  - name: Haley
date: 07-25-2020
output:
  distill::distill_article:
    self_contained: false
    toc: true
categories:
  - COVID
  - Visualization
  - Exploratory Data Analysis
  - Applied
```

5. Knit the `.Rmd` file to produce an `.html` file that comes with supplementary files. 

![](../lab_website_maintenance/images/blog_post.png)

6. Try to `Build Website` and see how it looks! :)

***

# Concluding Remarks

Don't worry -- I am always here to help. Problems occur all the time particularly at the beginning. Whenever issues come up -- broken links and images, failing to knit or build the website, or getting lost in all these tasks, you are always welcome to ask help from me. It will always be helpful for me to understand better your situation if you screenshot what problems you have on your end and briefly describe how you get there. 

Hope you have fun playing around with the website :) Don't hesitate to reach out to me if you find the workload too heavy or if you have any concerns!




